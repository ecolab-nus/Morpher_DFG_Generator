#include <string.h>
#include <stdio.h>


#define SIZE 8
int n = SIZE;
int A[SIZE][SIZE], B[SIZE][SIZE], C[SIZE][SIZE], temp[SIZE][SIZE];
int i,j;
void gemm(){



   int i0,i1,j0,j1,k0,k1;

   for (i0=0;i0<SIZE; i0=i0+2)
      for (j0=0; j0<SIZE; j0=j0+2)
        for (k0=0;k0<SIZE; k0=k0+2){
          // printf("\n");
          //  for (i1=i0;i1<i0+2; i1++)
          //    for (j1=j0; j1<j0+2; j1++)
          //      for (k1=k0;k1<k0+2; k1++){
          //        #ifdef CGRA_COMPILER
          //         please_map_me();
          //         #endif
          //         A[i1][j1] = A[i1][j1] + B[i1][k1]* C[k1][j1];
          //         printf("A[i0+%d][j0+%d]=A[i0+%d][j0+%d]+B[i0+%d][k0+%d]*C[k0+%d][j0+%d];\n",i1,j1,i1,j1,i1,k1,k1,j1);
		        //       //A[i][j] = A[i][j] + B[i][4*k]* C[4*k][j] + B[i][4*k+1]* C[4*k+1][j]
			       //       //   + B[i][4*k+2]* C[4*k+2][j] + B[i][4*k+3]* C[4*k+3][j];
          //      }

                 #ifdef CGRA_COMPILER
                  please_map_me();
                  #endif
                  A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+0]*C[k0+0][j0+0];
A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+1]*C[k0+1][j0+0];
A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+0]*C[k0+0][j0+1];
A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+1]*C[k0+1][j0+1];
A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+0]*C[k0+0][j0+0];
A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+1]*C[k0+1][j0+0];
A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+0]*C[k0+0][j0+1];
A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+1]*C[k0+1][j0+1];

//           A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+0]*C[k0+0][j0+0];
// A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+1]*C[k0+1][j0+0];
// A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+2]*C[k0+2][j0+0];
// A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+0]*C[k0+0][j0+1];
// A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+1]*C[k0+1][j0+1];
// A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+2]*C[k0+2][j0+1];
// A[i0+0][j0+2]=A[i0+0][j0+2]+B[i0+0][k0+0]*C[k0+0][j0+2];
// A[i0+0][j0+2]=A[i0+0][j0+2]+B[i0+0][k0+1]*C[k0+1][j0+2];
// A[i0+0][j0+2]=A[i0+0][j0+2]+B[i0+0][k0+2]*C[k0+2][j0+2];
// A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+0]*C[k0+0][j0+0];
// A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+1]*C[k0+1][j0+0];
// A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+2]*C[k0+2][j0+0];
// A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+0]*C[k0+0][j0+1];
// A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+1]*C[k0+1][j0+1];
// A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+2]*C[k0+2][j0+1];
// A[i0+1][j0+2]=A[i0+1][j0+2]+B[i0+1][k0+0]*C[k0+0][j0+2];
// A[i0+1][j0+2]=A[i0+1][j0+2]+B[i0+1][k0+1]*C[k0+1][j0+2];
// A[i0+1][j0+2]=A[i0+1][j0+2]+B[i0+1][k0+2]*C[k0+2][j0+2];
// A[i0+2][j0+0]=A[i0+2][j0+0]+B[i0+2][k0+0]*C[k0+0][j0+0];
// A[i0+2][j0+0]=A[i0+2][j0+0]+B[i0+2][k0+1]*C[k0+1][j0+0];
// A[i0+2][j0+0]=A[i0+2][j0+0]+B[i0+2][k0+2]*C[k0+2][j0+0];
// A[i0+2][j0+1]=A[i0+2][j0+1]+B[i0+2][k0+0]*C[k0+0][j0+1];
// A[i0+2][j0+1]=A[i0+2][j0+1]+B[i0+2][k0+1]*C[k0+1][j0+1];
// A[i0+2][j0+1]=A[i0+2][j0+1]+B[i0+2][k0+2]*C[k0+2][j0+1];
// A[i0+2][j0+2]=A[i0+2][j0+2]+B[i0+2][k0+0]*C[k0+0][j0+2];
// A[i0+2][j0+2]=A[i0+2][j0+2]+B[i0+2][k0+1]*C[k0+1][j0+2];
// A[i0+2][j0+2]=A[i0+2][j0+2]+B[i0+2][k0+2]*C[k0+2][j0+2];

          // A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+0]*C[k0+0][j0+0];
          // A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+1]*C[k0+1][j0+0];
          // A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+2]*C[k0+2][j0+0];
          // A[i0+0][j0+0]=A[i0+0][j0+0]+B[i0+0][k0+3]*C[k0+3][j0+0];
          // A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+0]*C[k0+0][j0+1];
          // A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+1]*C[k0+1][j0+1];
          // A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+2]*C[k0+2][j0+1];
          // A[i0+0][j0+1]=A[i0+0][j0+1]+B[i0+0][k0+3]*C[k0+3][j0+1];
          // A[i0+0][j0+2]=A[i0+0][j0+2]+B[i0+0][k0+0]*C[k0+0][j0+2];
          // A[i0+0][j0+2]=A[i0+0][j0+2]+B[i0+0][k0+1]*C[k0+1][j0+2];
          // A[i0+0][j0+2]=A[i0+0][j0+2]+B[i0+0][k0+2]*C[k0+2][j0+2];
          // A[i0+0][j0+2]=A[i0+0][j0+2]+B[i0+0][k0+3]*C[k0+3][j0+2];
          // A[i0+0][j0+3]=A[i0+0][j0+3]+B[i0+0][k0+0]*C[k0+0][j0+3];
          // A[i0+0][j0+3]=A[i0+0][j0+3]+B[i0+0][k0+1]*C[k0+1][j0+3];
          // A[i0+0][j0+3]=A[i0+0][j0+3]+B[i0+0][k0+2]*C[k0+2][j0+3];
          // A[i0+0][j0+3]=A[i0+0][j0+3]+B[i0+0][k0+3]*C[k0+3][j0+3];
          // A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+0]*C[k0+0][j0+0];
          // A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+1]*C[k0+1][j0+0];
          // A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+2]*C[k0+2][j0+0];
          // A[i0+1][j0+0]=A[i0+1][j0+0]+B[i0+1][k0+3]*C[k0+3][j0+0];
          // A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+0]*C[k0+0][j0+1];
          // A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+1]*C[k0+1][j0+1];
          // A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+2]*C[k0+2][j0+1];
          // A[i0+1][j0+1]=A[i0+1][j0+1]+B[i0+1][k0+3]*C[k0+3][j0+1];
          // A[i0+1][j0+2]=A[i0+1][j0+2]+B[i0+1][k0+0]*C[k0+0][j0+2];
          // A[i0+1][j0+2]=A[i0+1][j0+2]+B[i0+1][k0+1]*C[k0+1][j0+2];
          // A[i0+1][j0+2]=A[i0+1][j0+2]+B[i0+1][k0+2]*C[k0+2][j0+2];
          // A[i0+1][j0+2]=A[i0+1][j0+2]+B[i0+1][k0+3]*C[k0+3][j0+2];
          // A[i0+1][j0+3]=A[i0+1][j0+3]+B[i0+1][k0+0]*C[k0+0][j0+3];
          // A[i0+1][j0+3]=A[i0+1][j0+3]+B[i0+1][k0+1]*C[k0+1][j0+3];
          // A[i0+1][j0+3]=A[i0+1][j0+3]+B[i0+1][k0+2]*C[k0+2][j0+3];
          // A[i0+1][j0+3]=A[i0+1][j0+3]+B[i0+1][k0+3]*C[k0+3][j0+3];
          // A[i0+2][j0+0]=A[i0+2][j0+0]+B[i0+2][k0+0]*C[k0+0][j0+0];
          // A[i0+2][j0+0]=A[i0+2][j0+0]+B[i0+2][k0+1]*C[k0+1][j0+0];
          // A[i0+2][j0+0]=A[i0+2][j0+0]+B[i0+2][k0+2]*C[k0+2][j0+0];
          // A[i0+2][j0+0]=A[i0+2][j0+0]+B[i0+2][k0+3]*C[k0+3][j0+0];
          // A[i0+2][j0+1]=A[i0+2][j0+1]+B[i0+2][k0+0]*C[k0+0][j0+1];
          // A[i0+2][j0+1]=A[i0+2][j0+1]+B[i0+2][k0+1]*C[k0+1][j0+1];
          // A[i0+2][j0+1]=A[i0+2][j0+1]+B[i0+2][k0+2]*C[k0+2][j0+1];
          // A[i0+2][j0+1]=A[i0+2][j0+1]+B[i0+2][k0+3]*C[k0+3][j0+1];
          // A[i0+2][j0+2]=A[i0+2][j0+2]+B[i0+2][k0+0]*C[k0+0][j0+2];
          // A[i0+2][j0+2]=A[i0+2][j0+2]+B[i0+2][k0+1]*C[k0+1][j0+2];
          // A[i0+2][j0+2]=A[i0+2][j0+2]+B[i0+2][k0+2]*C[k0+2][j0+2];
          // A[i0+2][j0+2]=A[i0+2][j0+2]+B[i0+2][k0+3]*C[k0+3][j0+2];
          // A[i0+2][j0+3]=A[i0+2][j0+3]+B[i0+2][k0+0]*C[k0+0][j0+3];
          // A[i0+2][j0+3]=A[i0+2][j0+3]+B[i0+2][k0+1]*C[k0+1][j0+3];
          // A[i0+2][j0+3]=A[i0+2][j0+3]+B[i0+2][k0+2]*C[k0+2][j0+3];
          // A[i0+2][j0+3]=A[i0+2][j0+3]+B[i0+2][k0+3]*C[k0+3][j0+3];
          // A[i0+3][j0+0]=A[i0+3][j0+0]+B[i0+3][k0+0]*C[k0+0][j0+0];
          // A[i0+3][j0+0]=A[i0+3][j0+0]+B[i0+3][k0+1]*C[k0+1][j0+0];
          // A[i0+3][j0+0]=A[i0+3][j0+0]+B[i0+3][k0+2]*C[k0+2][j0+0];
          // A[i0+3][j0+0]=A[i0+3][j0+0]+B[i0+3][k0+3]*C[k0+3][j0+0];
          // A[i0+3][j0+1]=A[i0+3][j0+1]+B[i0+3][k0+0]*C[k0+0][j0+1];
          // A[i0+3][j0+1]=A[i0+3][j0+1]+B[i0+3][k0+1]*C[k0+1][j0+1];
          // A[i0+3][j0+1]=A[i0+3][j0+1]+B[i0+3][k0+2]*C[k0+2][j0+1];
          // A[i0+3][j0+1]=A[i0+3][j0+1]+B[i0+3][k0+3]*C[k0+3][j0+1];
          // A[i0+3][j0+2]=A[i0+3][j0+2]+B[i0+3][k0+0]*C[k0+0][j0+2];
          // A[i0+3][j0+2]=A[i0+3][j0+2]+B[i0+3][k0+1]*C[k0+1][j0+2];
          // A[i0+3][j0+2]=A[i0+3][j0+2]+B[i0+3][k0+2]*C[k0+2][j0+2];
          // A[i0+3][j0+2]=A[i0+3][j0+2]+B[i0+3][k0+3]*C[k0+3][j0+2];
          // A[i0+3][j0+3]=A[i0+3][j0+3]+B[i0+3][k0+0]*C[k0+0][j0+3];
          // A[i0+3][j0+3]=A[i0+3][j0+3]+B[i0+3][k0+1]*C[k0+1][j0+3];
          // A[i0+3][j0+3]=A[i0+3][j0+3]+B[i0+3][k0+2]*C[k0+2][j0+3];
          // A[i0+3][j0+3]=A[i0+3][j0+3]+B[i0+3][k0+3]*C[k0+3][j0+3];



        }


}

void gemm_original(){



   int i,j,k;

   for (i=0;i<SIZE; i++)
      for (j=0; j<SIZE; j++)
        for (k=0;k<SIZE; k++){
           A[i][j] = A[i][j] + B[i][k]* C[k][j];
           //A[i][j] = A[i][j] + B[i][4*k]* C[4*k][j] + B[i][4*k+1]* C[4*k+1][j]
           //   + B[i][4*k+2]* C[4*k+2][j] + B[i][4*k+3]* C[4*k+3][j];
            }


}

void main(){

int i,j;
for (i=0;i<n; i++)
   for (j=0; j<n; j++) {
      A[i][j]=0;
      B[i][j] = j+i;
      C[i][j] = j*i;
    }
    
gemm();

for (i=0;i<n; i++)
   for (j=0; j<n; j++) {
      // printf("%d\n", A[i][j]);
      temp[i][j] = A[i][j];
    }

for (i=0;i<n; i++)
   for (j=0; j<n; j++) {
      A[i][j]=0;
      B[i][j] = j+i;
      C[i][j] = j*i;
    }
    
gemm_original();

for (i=0;i<n; i++)
   for (j=0; j<n; j++) {
      if (A[i][j]!=temp[i][j])
      {
        printf("INCORRECT %d,%d\n",temp[i][j],A[i][j]);
      }
    }

}


